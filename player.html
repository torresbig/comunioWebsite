<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Spieler Details</title>
    <link rel="stylesheet" href="css/debugPanel.css">
    <link rel="stylesheet" href="css/tabelStyle.css">
    <link rel="stylesheet" href="css/playerTable.css">
    <link rel="stylesheet" href="css/buttonBack.css">
    <link rel="stylesheet" href="css/styleMenueHamburger.css">
    <link rel="stylesheet" href="css/stylePlayer.css">
    <style>

    </style>

</head>

<body>

    <!-- Debug Button -->
    <button id="floatingDebugBtn" title="Debug">ğŸ</button>
    <div id="floatingDebugPanel">
        <div id="floatingDebugPanelHeader">
            Debug-Informationen
            <button id="floatingDebugPanelClose" title="SchlieÃŸen">Ã—</button>
        </div>
        <div id="floatingDebugContent"></div>
    </div>

    <div class="hamburger-menu">
        <button class="hamburger-button" id="hamburgerButton">
            <div class="hamburger-line"></div>
            <div class="hamburger-line"></div>
            <div class="hamburger-line"></div>
        </button>
        <div class="hamburger-dropdown" id="hamburgerDropdown">
            <a href="#" class="menu-item" id="linkPlayerDb">ğŸ“‹ Spielerdatenbank</a>
            <a href="#" class="menu-item" id="linkIndex">ğŸ“° News</a>
            <a href="#" class="menu-item" id="linkTransfermarktComunio">ğŸ“‘ Transfermarkt-Liste</a>
            <a href="#" class="menu-item" id="linkTransferuebersicht">ğŸ”„ TransferÃ¼bersicht</a>
            <a href="#" class="menu-item" id="linkUseruebersicht">ğŸ‘¤ UserÃ¼bersicht</a>
            <a href="https://www.instagram.com/comuniofanapp/." class="menu-item" target="_blank">ğŸ“¸ Instagram:
                ComunioFanApp</a>
            <div class="menu-item menu-tarn" id="menuTarnItem" style="font-size:0.95em; color:#888; cursor:pointer;">
                erstellt von comunioFanApp</div>
        </div>
    </div>
    <nav class="navbar">
        
        <div class="player-header">
            <div class="player-center">
                <div class="player-row">
                    <div class="club-logo" id="clubLogo"></div>
                    <div>
                        <a href="#" id="playerNameLink" class="player-name" target="_blank">Lade Spieler...</a>
                        <div id="playerId" class="player-id"></div>
                    </div>
                    <div class="status-wrapper">
                        <div id="statusIndicator" class="status-indicator"></div>
                    </div>
                </div>
                <div class="player-row">
                    <div class="player-info">
                        <span id="playerOwner" class="player-owner-label">Besitzer:</span>
                        <span id="playerOwnerName" class="player-owner-name">-</span>
                    </div>
                </div>
            </div>
        </div>

    </nav>
    <div class="container">
        <div id="errorMessage" style="display:none; color: red; font-weight: bold; margin-bottom: 10px;"></div>
        <div id="loadingIndicator" style="text-align:center; padding: 20px;">Lade Daten...</div>
        <div id="playerContent" style="display:none;">
            <!-- Info-Karten und Tabs jetzt innerhalb von playerContent -->
            <div class="info-card">
                <h3 id="playerInfoHeader">ğŸ“‹ Spieler-Informationen</h3>
                <div class="info-card-content">
                    <div class="info-row"><span class="info-label">Geburtstag:</span><span class="info-value"
                            id="birthday">-</span></div>
                    <div class="info-row"><span class="info-label">Alter:</span><span class="info-value"
                            id="age">-</span></div>
                    <div class="info-row"><span class="info-label">GrÃ¶ÃŸe:</span><span class="info-value"
                            id="height">-</span></div>
                    <div class="info-row"><span class="info-label">NationalitÃ¤t:</span><span class="info-value"
                            id="nationality">-</span></div>
                    <div class="info-row"><span class="info-label">Position:</span><span class="info-value"
                            id="position">-</span></div>
                    <div class="info-row"><span class="info-label">HauptfuÃŸ:</span><span class="info-value"
                            id="foot">-</span></div>
                    <div class="info-row"><span class="info-label">Trikotnummer:</span><span class="info-value"
                            id="jerseyNumber">-</span></div>
                </div>
            </div>
            <div class="info-card" id="ligainsiderPanel" style="display:none;">
                <h3>ğŸ† Ligainsider-Ranking</h3>
                <div class="info-card-content" id="ligainsiderPanelContent"></div>
            </div>
            <div class="info-card">
                <h3>âš½ Comunio</h3>
                <div class="info-card-content">
                    <div class="info-row"><span class="info-label">Position:</span><span class="info-value"
                            id="comunioPosition">-</span></div>
                    <div class="info-row"><span class="info-label">Marktwert:</span><span class="info-value"
                            id="marketValue">-</span></div>
                    <div class="info-row"><span class="info-label">realer Marktwert (Transfermarkt.de):</span><span
                            class="info-value" id="realmarketValue">-</span></div>
                    <div class="info-row"><span class="info-label">Punkte (letztes Jahr):</span><span class="info-value"
                            id="pointsWithLastYear">-</span></div>
                    <div class="info-row"><span class="info-label">Besitzer:</span><span class="info-value"
                            id="owner">-</span></div>
                            <div class="info-row"><span class="info-label">gewÃ¤hlt fÃ¼r 11 des Tages:</span><span class="info-value"
                            id="11desTages">-</span></div>
                </div>
            </div>
            <div class="info-card">
                <h3>
                    <svg class="stat-icon" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="13" width="3" height="8" rx="1" fill="#764ba2" />
                        <rect x="8" y="9" width="3" height="12" rx="1" fill="#764ba2" />
                        <rect x="13" y="5" width="3" height="16" rx="1" fill="#764ba2" />
                        <rect x="18" y="2" width="3" height="19" rx="1" fill="#764ba2" />
                    </svg>
                    Status & Statistik
                </h3>
                <div class="info-card-content">
                    <div class="info-row"><span class="info-label">Status:</span><span class="info-value"
                            id="detailStatus">-</span></div>
                            <div class="info-row"><span class="info-label">Status-Infos:</span><span class="info-value"
                            id="detailStatusInfo">-</span></div>
                    <div class="info-row"><span class="info-label">Spiele:</span><span class="info-value"
                            id="gamesPlayed">-</span></div>
                    <div class="info-row"><span class="info-label">Tore:</span><span class="info-value"
                            id="goals">-</span></div>
                    <div class="info-row"><span class="info-label">Notenschnitt:</span><span class="info-value"
                            id="averageRating">-</span></div>
                    <div class="info-row"><span class="info-label">Gelbe Karten:</span><span class="info-value"
                            id="yellowCards">-</span></div>
                    <div class="info-row"><span class="info-label">Rote Karten:</span><span class="info-value"
                            id="redCards">-</span></div>
                </div>
            </div>
            <div class="info-card" id="attributesCard" style="display:none;">
                <h3>â­ Besondere Eigenschaften</h3>
                <div class="info-card-content">
                    <div class="attributes" id="attributesList"></div>
                </div>
            </div>
            <!-- Tabs: Rivalen, Marktwerte, Punkte, Transfers -->
            <div class="tabs" id="tabBar">
                <button class="tab-button" data-tab="rivals">Rivalen</button>
                <button class="tab-button" data-tab="market">Marktwerte <span id="marketTabTrend"
                        class="trend-arrow"></span></button>
                <button class="tab-button" data-tab="points">Spieltaginfos</button>
                <button class="tab-button" data-tab="transfers">Transfers</button>
            </div>

            <div id="rivals" class="tab-content">
                <h3 id="rivalsHeader">Direkte Konkurrenten im Team</h3>
                <div id="rivalsList"></div>
            </div>

            <div id="market" class="tab-content">
                <div style="display:flex;justify-content:center;margin-bottom:8px;">
                    <button id="marketGraphToggle"
                        style="padding:6px 14px;border-radius:7px;border:1px solid #3498db;background:#3498db;color:white;font-size:14px;cursor:pointer;">
                        30 Tage anzeigen
                    </button>
                </div>
                <div style="display:flex;justify-content:center;">
                    <div style="width:98%;max-width:680px;">
                        <canvas id="marketValueGraph" width="600" height="230"></canvas>
                    </div>
                </div>

                <div id="marketValueChart"></div>

            </div>


            <div id="points" class="tab-content">
                <div id="pointsHistory"></div>
            </div>

            <!-- Neuer Transfers-Tab -->
            <div id="transfers" class="tab-content">
                <h3>Transfers</h3>
                <div class="table-container">
                    <table id="transfersTable" class="table-container">

                        <thead>
                            <tr>
                                <th>Datum</th>
                                <th>VerkÃ¤ufer</th>
                                <th>KÃ¤ufer</th>
                                <th>Preis (â‚¬)</th>
                                <th>Wert bei Kauf (â‚¬)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Wird per JS gefÃ¼llt -->
                        </tbody>
                    </table>
                </div>
                <!-- Optional: Hinweistexte -->
                <div id="transfersEmpty" style="display:none; padding:10px 0; color:#666;">
                    Keine Transfers fÃ¼r diesen Spieler gefunden.
                </div>
            </div>
            <!-- Ende Transfers-Tab -->
        </div>
    </div>
    <div id="tm-link-btn">Transfermarkt-Link eintragen</div>
    <div id="tm-link-modal">
        <div id="tm-link-modal-content">
            <button id="tm-link-modal-close" title="SchlieÃŸen">Ã—</button>
            <h2>Transfermarkt-Link eintragen</h2>
            <input type="text" id="tm-link-input" placeholder="Transfermarkt-Link hier einfÃ¼gen..." />
            <button id="tm-link-save">Speichern</button>
            <div id="tm-link-modal-msg" style="margin-top:10px; color:#c00; font-size:13px;"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
     <script src="js/ownerMap.js"></script>
    <script src="js/playerDisplayInfos.js"></script>
    <script src="js/playerMarktwerte.js"></script>
    <script src="js/playerLigainsiderRanking.js"></script>
    <script src="js/playerDisplayTabs.js"></script>
    <script src="js/hamburgerMenu.js"></script>
    <script src="js/debugPanel.js"></script>
    <script src="js/playerTransfers.js"></script>
    <script>


        addDebug('Script gestartet', 'info');

        // URL-Parameter (werden nach dem Laden der Daten gesetzt)
    let urlParams = {withMenue: true };

    // Liest URL-Parameter: ?username=Name&withMenue=false
    function getUrlParams() {
      const params = new URLSearchParams(window.location.search);
      return {
        withMenue: params.get('withMenue') !== 'false'
      };
    }

       // Verarbeitet Params (z.B. MenÃ¼ ausblenden)
    function processUrlParams(params) {
      // MenÃ¼ anzeigen/ausblenden
      const hamburgerMenu = document.querySelector('.hamburger-menu');
      if (hamburgerMenu) hamburgerMenu.style.display = params.withMenue ? '' : 'none';
      // Merken fÃ¼r spÃ¤teren Gebrauch (initUserDropdown)
      urlParams = params;
    }

    </script>
</body>

</html>